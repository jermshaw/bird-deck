import { useState } from 'react';
import { Bird, sizeIcons } from '@shared/birds';
import { useCollection } from '@/hooks/use-collection';
import { useHolographicCard } from '@/hooks/use-holographic-card';
import { Dialog, DialogContent, DialogTitle } from '@/components/ui/dialog';
import { Button } from '@/components/ui/button';
import { BirdPhotoCarousel } from '@/components/BirdPhotoCarousel';
import { cn } from '@/lib/utils';
import { Plus, Check, X } from 'lucide-react';

interface BirdDetailModalProps {
  bird: Bird | null;
  open: boolean;
  onOpenChange: (open: boolean) => void;
}

export function BirdDetailModal({ bird, open, onOpenChange }: BirdDetailModalProps) {
  const { isInCollection, addToCollection, removeFromCollection } = useCollection();
  const { cardProps, glareProps, shineProps, isHovered } = useHolographicCard({
    maxTilt: 18,
    scale: 1.1,
    speed: 150,
    glareIntensity: 0.6,
    shineIntensity: 0.8
  });


  const isCollected = bird ? isInCollection(bird.id) : false;


  const handleCollectionToggle = () => {
    if (!bird) return;
    if (isCollected) {
      removeFromCollection(bird.id);
    } else {
      addToCollection(bird.id);
    }
  };

  const sizeComparisonIcons = [
    { size: 'tiny', active: bird?.size === 'tiny' },
    { size: 'small', active: bird?.size === 'small' },
    { size: 'medium', active: bird?.size === 'medium' },
    { size: 'large', active: bird?.size === 'large' },
    { size: 'huge', active: bird?.size === 'huge' }
  ];

  return (
    <Dialog open={open && bird !== null} onOpenChange={onOpenChange}>
      <DialogContent className="max-w-none max-h-none w-full h-full p-0 bg-transparent border-none overflow-hidden">
        <DialogTitle className="sr-only">
          {bird?.name || 'Bird'} - Bird Details
        </DialogTitle>
        {bird && (
        <div className="w-full relative font-rubik overflow-y-auto" style={{ minHeight: '100dvh' }}>
          {/* Blurred Background - Fixed */}
          {isCollected ? (
            // Colorful gradient background using bird's colors when collected
            <div
              className="fixed inset-0 z-0"
              style={{
                background: bird.colors && bird.colors.length > 0
                  ? `linear-gradient(135deg, ${bird.colors.map((color, index) => {
                      // Convert hex to rgba with transparency
                      const hex = color.replace('#', '');
                      const r = parseInt(hex.substr(0, 2), 16);
                      const g = parseInt(hex.substr(2, 2), 16);
                      const b = parseInt(hex.substr(4, 2), 16);
                      const alpha = 0.7 + (index * 0.05); // Varying transparency
                      return `rgba(${r}, ${g}, ${b}, ${alpha})`;
                    }).join(', ')})`
                  : 'linear-gradient(135deg, rgba(79, 70, 229, 0.8) 0%, rgba(236, 72, 153, 0.8) 50%, rgba(34, 197, 94, 0.8) 100%)',
                filter: 'blur(120px) saturate(1.4) brightness(1.2)'
              }}
            />
          ) : (
            // Grayscale blurred image for uncollected birds
            <div
              className="fixed inset-0 bg-cover bg-center z-0"
              style={{
                backgroundImage: `url(${bird.imageUrl})`,
                filter: 'blur(150px) grayscale(100%) brightness(0.7)',
                backgroundColor: '#9CA3AF'
              }}
            />
          )}

          {/* Background Overlay for Text Legibility - Fixed */}
          <div
            className="fixed inset-0 z-0"
            style={{
              background: isCollected
                ? 'rgba(0, 0, 0, 0.2)' // Slightly stronger overlay for colorful backgrounds
                : 'rgba(156, 163, 175, 0.6)'
            }}
          />

          {/* Content Container */}
          <div className="relative z-10 flex flex-col w-full max-w-sm mx-auto px-6 py-16 sm:py-20">



            {/* Main Bird Card */}
            <div
              {...cardProps}
              className={`bg-white rounded-2xl overflow-hidden mb-8 gpu-accelerated transition-shadow duration-150 relative ${
                isHovered
                  ? 'shadow-[0_25px_60px_rgba(0,0,0,0.4),0_0_30px_rgba(255,255,255,0.15),inset_0_2px_0_rgba(255,255,255,0.7)]'
                  : 'shadow-lg'
              }`}
            >
              {/* Holographic Glare Effect */}
              <div
                className="absolute inset-0 rounded-2xl pointer-events-none z-10"
                {...glareProps}
              />

              {/* Holographic Shine Effect */}
              <div
                className="absolute inset-0 rounded-2xl pointer-events-none z-10"
                {...shineProps}
              />
              {/* Card Content */}
              <div className="relative p-1 z-0">
                {/* Bird Image */}
                <div className="relative aspect-[35/52] rounded-xl overflow-hidden border border-black">
                  <img
                    src={bird.imageUrl}
                    alt={bird.name}
                    className={`w-full h-full object-cover transition-all duration-300 ${
                      !isCollected ? 'grayscale' : ''
                    }`}
                  />

                  {/* Rarity Badge */}
                  <div className="absolute top-2 right-2 w-6 h-6 bg-[#F3F3F3] border border-[#2C2C2C] rounded-full flex items-center justify-center">
                    <svg
                      width="12"
                      height="10"
                      viewBox="0 0 8 15"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                      className="w-3 h-2.5 fill-[#2C2C2C] transform rotate-[-23.972deg]"
                    >
                      <path d="M6.80255 0.39989C7.2046 0.0565747 7.79657 0.141577 7.82664 0.549448C7.87776 0.948024 7.90655 1.46684 7.87151 2.06849C7.81534 3.24752 6.58006 5.15219 5.30671 5.97482L7.38227 5.05195C7.20793 5.62405 6.9769 6.23934 6.66944 6.85232C6.30497 7.5639 5.934 8.26036 5.53553 8.89549L4.38439 9.75574L4.9811 9.74692C3.73732 11.6006 2.84391 12.1447 2.03342 12.1936C2.55555 9.96461 2.78201 8.95583 4.46463 6.88361C2.91991 8.70524 2.25359 10.0244 1.62073 12.1741C1.74943 12.1982 1.86808 12.1976 2.00526 12.188C1.74894 13.1996 1.67207 13.8202 1.65036 13.8848C1.62797 14.0046 1.50066 14.1164 1.35393 14.1267C1.20719 14.137 1.11769 14.0477 1.119 13.9372L1.11225 13.9221C1.13426 13.8556 1.25174 13.2748 1.5899 12.1792C1.57575 12.1786 1.56048 12.1757 1.54518 12.1724C0.220929 11.9735 0.155025 9.84108 2.12819 5.94103L2.91001 6.43985C2.87025 5.66976 3.03111 5.19109 3.36163 4.40293C3.69894 3.63018 4.1965 2.87754 4.86803 2.17597C4.88904 2.16658 4.90361 2.14198 4.92464 2.13263C5.25854 2.82686 5.54558 2.99795 5.54558 2.99795L6.01943 1.07834C6.30873 0.821472 6.56282 0.598078 6.80255 0.39989Z" fill="#2C2C2C"/>
                    </svg>
                  </div>

                  {/* Name Box - positioned at bottom of image */}
                  <div className="absolute bottom-0 left-0 right-0">
                    <div className="bg-white/70 backdrop-blur-sm border-t border-black mx-[-1px] rounded-b-xl">
                      <div className="px-4 py-2 text-center flex flex-col justify-center items-center ml-0.5">
                        <h3 className="text-[#2C2C2C] font-rubik font-bold text-sm uppercase leading-tight">
                          {bird.name}
                        </h3>
                        <p className="text-[#2C2C2C]/50 font-rubik text-xs italic mt-1">
                          {bird.ability}
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>


            {/* Content Sections */}
            <div className="space-y-10">
              
              {/* About Section */}
              <div className="space-y-3">
                <h3 className="text-base font-bold uppercase tracking-widest text-white">
                  About
                </h3>
                <p className="text-base leading-6 text-white/70">
                  {bird.description}
                </p>
              </div>

              {/* Odd Facts Section */}
              <div className="space-y-3">
                <h3 className="text-base font-bold uppercase tracking-widest text-white">
                  Odd Facts
                </h3>
                <p className="text-base leading-6 text-white/70">
                  {bird.funFact}
                </p>
              </div>

              {/* Photos Section */}
              {bird.additionalImages && bird.additionalImages.length > 0 && (
                <div className="space-y-5">
                  <h3 className="text-base font-bold uppercase tracking-widest text-white">
                    Photos
                  </h3>
                  <BirdPhotoCarousel
                    images={bird.additionalImages}
                    birdName={bird.name}
                    isCollected={isCollected}
                  />
                </div>
              )}

              {/* Size Section */}
              <div className="space-y-7">
                <h3 className="text-base font-bold uppercase tracking-widest text-white">
                  Size
                </h3>
                
                {/* Size Comparison Icons */}
                <div className="flex items-end justify-center gap-4 px-4">
                  {/* S - Tiny */}
                  <div className="flex flex-col items-center">
                    <svg 
                      className={`w-8 h-8 transition-colors duration-200 ${bird.size === 'tiny' ? 'fill-white' : 'fill-white/40'}`} 
                      viewBox="0 0 64 64" 
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path d="M34.8685 52.5194C35.5217 52.6875 36.5538 52.8283 37.8325 52.592C38.0243 52.5557 38.2299 52.5784 38.4217 52.6511C38.9846 52.8976 40.9415 53.0896 42.0159 52.9511C42.171 52.9327 42.3217 52.91 42.4679 52.8827C42.8195 54.1052 42.8789 55.7861 42.1208 57.3945C41.198 59.5698 38.3883 61.2783 35.6264 61.7565L36.5204 63.09H39.6444C40.2495 63.1025 40.2404 63.9873 39.6444 63.9987H36.2889C36.2787 64.0009 36.2684 63.9998 36.2581 63.9987H32.8544C32.8442 64.0009 32.8339 63.9998 32.8236 63.9987H29.2592C29.0068 63.9987 28.8025 63.7953 28.8025 63.5443C28.8025 63.2933 29.0068 63.09 29.2592 63.09H31.9856C31.9571 63.0241 30.8336 61.435 30.9044 61.4111C29.8449 61.0113 29.0228 60.4433 28.42 59.9208C28.0364 59.939 27.6573 59.9526 27.2919 59.9526C22.4967 59.9129 18.1876 58.092 19.1307 57.6217L21.6836 56.8267C21.3914 56.5768 21.0443 56.1405 20.9712 55.4772C20.9621 55.3681 21.0306 55.2636 21.1402 55.2363C21.2451 55.2091 23.4739 54.6184 25.1226 55.3408C24.8029 56.1246 24.5414 56.8845 24.3325 57.7262C24.2594 58.0011 24.4923 58.2987 24.7755 58.2942C25.3247 58.4091 34.9164 57.8322 34.8685 52.5194ZM32.206 61.7792L33.0863 63.09H35.4201L34.6357 61.9246L34.0372 61.9248C33.4188 61.9254 32.7575 61.9146 32.206 61.7792ZM26.6162 54.3643C27.8014 54.9254 31.1283 55.123 33.1058 54.6414C31.2015 56.8312 26.9541 57.2719 25.3785 57.3628C25.7119 56.227 26.1367 55.2321 26.6162 54.3643ZM31.375 49.4436L32.9095 50.5886C33.8286 51.2769 34.2259 52.5105 33.7772 53.5646C30.3198 54.3962 28.0227 53.8737 27.0956 53.5647C28.7261 51.0248 30.7082 49.8071 31.375 49.4436ZM36.9513 44C40.646 44.0047 41.8791 46.8989 42.0891 47.4714L44.8841 49.0026C45.0554 49.0866 45.0302 49.3535 44.8521 49.416C44.8339 49.4251 43.482 49.9022 42.5275 50.402C42.6463 51.0244 42.5549 51.5878 42.4408 51.9695C41.2785 52.2228 39.293 52.024 38.7506 51.8059C38.399 51.6696 38.0199 51.6333 37.6637 51.7014C36.7778 51.9309 35.1474 51.7435 34.6724 51.5106C34.4486 50.8745 34.0331 50.2975 33.4576 49.8658L31.777 48.6072C31.6582 48.5027 31.4995 48.4277 31.3431 48.4618C31.5532 47.9347 32.0144 46.9443 32.7954 46.031C32.905 46.1173 33.0238 46.2127 33.1562 46.3081C34.1883 47.0805 35.8872 48.1256 37.6089 48.1937C37.7505 48.7117 38.23 49.0889 38.7918 49.0889C40.4096 49.0468 40.4142 46.6887 38.7918 46.6444C38.3305 46.6444 37.924 46.9034 37.7094 47.2805C36.2753 47.2578 34.7682 46.3536 33.8091 45.6493C33.6721 45.5539 33.5488 45.4631 33.4392 45.3722C34.307 44.5941 35.4625 43.9989 36.9513 44ZM39.1068 47.8668C39.108 48.2769 38.4788 48.2769 38.4766 47.8668C38.4788 47.4568 39.1079 47.4568 39.1068 47.8668Z"/>
                    </svg>
                  </div>

                  {/* M - Small */}
                  <div className="flex flex-col items-center">
                    <svg 
                      className={`w-8 h-8 transition-colors duration-200 ${bird.size === 'small' ? 'fill-white' : 'fill-white/40'}`} 
                      viewBox="0 0 64 64" 
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <g transform="translate(13, 34)">
                        <path d="M31.7539 10.3888C33.8285 17.7188 22.0538 18.762 16.5283 18.8664C13.9472 18.904 11.2802 18.7418 9.41897 18.5382C7.60361 20.0693 3.1419 22.919 0.16018 24.6896C-0.133906 24.8505 0.00705437 25.34 0.338891 25.3263C2.72318 24.9517 4.91794 24.3638 6.84573 23.7121C4.47849 25.5133 2.26745 27.3277 2.22073 27.3585C1.95044 27.5655 2.17257 28.0141 2.49416 27.9611C8.66787 26.9087 12.3721 24.3617 15.7696 22.2267C16.6145 22.5825 17.4303 22.8718 18.2188 23.089C18.3796 23.8246 18.9615 24.8557 19.9707 25.4767L20.8125 28.3566H16.2002C15.3007 28.3739 15.3007 29.7074 16.2002 29.7248C20.4731 29.723 26.4711 29.7265 30.7188 29.7248C31.6255 29.7111 31.6083 28.3669 30.7188 28.3566H27.5323L26.7041 25.6144C28.0382 25.0671 28.5173 23.3976 28.6406 22.8293C28.6612 22.7334 28.6407 22.6369 28.586 22.5617C34.0037 19.9594 35.6225 16.8426 35.9424 11.9552C34.6714 11.2932 32.8454 10.4692 31.7539 10.3888ZM23.3096 24.4777C23.7269 25.0114 24.3909 25.6131 25.3145 25.757L26.1084 28.3556H22.2422L21.4414 25.6408C22.2283 25.5108 22.858 24.984 23.3096 24.4777ZM23.166 5.58413C22.4133 6.48739 21.5783 7.32955 20.5176 7.97281C15.2628 11.1612 11.6568 15.6495 10.4658 17.258C14.321 17.6499 33.8387 18.4795 30.1045 9.87515C29.1292 7.59825 26.288 5.42175 23.166 5.58413ZM30.3448 0.00796264C27.3545 0.151648 25.8551 2.10846 24.2676 4.18863C24.182 4.33061 24.8119 4.2801 24.9932 4.3605C27.9288 4.9147 30.1327 6.89161 31.2207 9.02652C32.3361 8.90357 33.9647 9.49866 35.2852 10.1007C35.5247 10.2171 35.7576 10.3272 35.9766 10.4367C35.9561 8.48646 35.716 6.81629 35.5996 6.09097C36.3523 5.91991 37.3788 5.69437 38.6035 5.88589C38.9027 5.9389 39.1271 5.55804 38.919 5.33218C38.6863 5.0516 36.8316 2.855 35.333 2.62906C34.97 1.87635 33.6563 -0.14236 30.3448 0.00796264ZM31.083 2.12222C32.1711 2.1393 32.1711 3.76136 31.083 3.77847C29.9954 3.76109 29.9954 2.13963 31.083 2.12222Z"/>
                      </g>
                    </svg>
                  </div>

                  {/* L - Medium */}
                  <div className="flex flex-col items-center">
                    <svg 
                      className={`w-8 h-8 transition-colors duration-200 ${bird.size === 'medium' ? 'fill-white' : 'fill-white/40'}`} 
                      viewBox="0 0 64 64" 
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path d="M31.2884 32.6079C30.9826 33.5886 30.4049 34.3676 29.6302 34.8685C28.1692 35.8144 26.8372 37.2474 25.4033 39.5012C25.9062 39.1325 26.4023 38.8195 26.8916 38.5551C28.6043 37.623 30.2013 37.2474 31.5196 37.2891C33.6533 37.3726 35.291 38.5203 36.0249 40.4401C36.4599 41.5807 36.1541 43.278 35.1891 45.1075C33.9182 47.4933 31.3426 50.3035 27.7341 51.4304C27.1225 52.3207 26.2798 53.232 25.308 54.1293C25.1382 54.2893 24.9683 54.4493 24.7848 54.6024C25.2605 55.5206 26.1303 57.176 26.9798 58.5602C27.1769 58.8733 27.4623 59.1098 27.8089 59.2211L29.0321 62.6087H25.5273C24.6269 62.6313 24.6387 63.9773 25.5273 63.9999H41.2662C42.1633 63.9895 42.1531 62.6157 41.2662 62.6087H36.4599L34.8222 58.2613C36.3716 55.9032 36.6026 53.3921 36.6366 52.6617C39.5519 50.5729 42.1648 47.6863 43.5001 44.7944C45.3417 40.7739 44.127 37.6559 44.0166 34.4091C44.037 34.1657 44.1593 34.0249 44.3156 33.8597C45.0767 33.0563 45.8072 33.3467 46.3968 33.5919C46.9286 33.7901 47.0815 34.35 47.1222 34.8752C47.1511 35.1639 47.5283 35.2909 47.7135 35.0631C48.3591 34.4113 50.0682 31.6373 48.0329 29.8948C47.972 28.9907 47.4079 24.6641 42.4741 24.0728C37.3434 23.4678 33.164 26.6606 31.2884 32.6079ZM30.6154 57.364C31.4819 57.7622 31.8132 59.5047 33.0143 59.5482C33.2793 59.5742 33.5596 59.5168 33.7958 59.3951L35.0054 62.6088H30.4863L30.466 62.5524C30.3963 62.3588 30.1569 61.6941 29.9038 60.9916L29.7654 60.6074C29.4666 59.7779 29.1884 59.0056 29.1884 59.0056C29.6657 58.6595 30.1278 58.1569 30.6154 57.364ZM25.5933 51.9102C24.9307 52.0146 24.3123 52.0719 23.7448 52.098C21.1166 53.7672 18.3169 54.9619 16.6639 55.6314L14 60.3615C17.0375 58.6017 22.6167 55.1587 25.5933 51.9102ZM18.7163 51.131L16.7047 54.1152C17.9212 53.6143 19.5589 52.8909 21.2375 51.9658C20.1026 51.7779 19.2803 51.4441 18.7163 51.131ZM21.2306 46.0256C22.1548 46.7559 24.8591 48.168 29.9764 45.5178C30.7834 45.1143 31.3832 46.3264 30.5949 46.7559C26.9219 48.7158 23.0451 49.1105 20.4899 47.1942C20.0142 47.9871 19.5521 48.8427 19.1104 49.7609C19.9189 50.2757 22.1343 51.2565 26.4427 50.3383C26.6806 50.2879 26.9133 50.2322 27.1359 50.1644C30.4523 49.2046 32.8308 46.6309 33.9929 44.4398C34.7336 43.0416 35.0326 41.6713 34.7608 40.9478C34.2239 39.5427 33.055 38.7427 31.4717 38.6801C27.8901 38.4418 23.3695 42.5476 21.2306 46.0256ZM43.1195 27.5434C43.106 28.4633 41.7689 28.4703 41.7536 27.5434C41.7723 26.6183 43.1026 26.6252 43.1195 27.5434Z"/>
                    </svg>
                  </div>

                  {/* XL - Large */}
                  <div className="flex flex-col items-center">
                    <svg 
                      className={`w-8 h-8 transition-colors duration-200 ${bird.size === 'large' ? 'fill-white' : 'fill-white/40'}`} 
                      viewBox="0 0 64 64" 
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <g clipPath="url(#clip0_57_557)">
                        <path d="M53.6494 18.4456C53.6217 18.4364 50.3007 17.6252 48.7601 14.9336C46.267 10.8502 40.8705 8.76476 37.4503 14.6387C34.655 19.3213 35.2916 26.9535 35.9189 31.083C36.0665 32.0509 35.5868 33.0003 34.7196 33.4335C33.3635 34.1248 32.1643 34.7792 31.1034 35.4153C32.3811 35.1618 33.7279 35.0973 35.0609 35.2033C35.5683 35.2401 35.9373 35.6919 35.9004 36.1989C35.8543 36.7058 35.4115 37.0837 34.8949 37.0376C26.8045 36.3371 20.9371 44.1722 19.1658 46.8823C20.0976 47.1589 21.5829 47.3709 22.9113 46.5597C23.5547 46.1288 24.4473 46.7326 24.3043 47.4907C24.2951 47.5553 24.1382 48.4586 23.594 49.4634C25.9833 49.0209 29.4611 47.9609 30.7155 45.4998C31.2067 44.4928 32.7588 45.1287 32.4129 46.1911L31.269 49.8412C33.483 49.0393 37.339 47.2972 38.9903 44.4029C39.8391 42.928 39.9959 41.361 39.4793 39.6096C39.1495 38.4505 40.8907 37.9274 41.2505 39.0842C43.9027 47.348 32.7173 51.6108 30.0788 52.1459C29.41 52.3326 28.7481 51.6458 28.981 50.9752L29.516 49.2699C26.1396 51.3623 21.5178 51.602 21.2598 51.6205C20.3373 51.6574 19.9152 50.3738 20.7524 49.8967C21.186 49.6479 21.5273 49.2792 21.7764 48.9013C19.4793 49.27 17.4682 48.21 17.3575 48.1547C16.9193 47.9196 16.7371 47.3182 16.9885 46.8919C17.0715 46.7536 17.6343 45.7488 18.6398 44.3938C18.8797 44.062 19.1472 43.7117 19.4424 43.343C16.1791 43.9399 13.6145 42.8107 13.3075 39.4256C13.2752 38.9854 12.6156 38.8495 12.4311 39.2597C12.4034 39.3242 9.32225 45.5648 13.2613 49.9616C12.6155 50.1551 11.5823 50.321 10.7152 49.7495C10.5399 49.6389 10.3185 49.6482 10.1617 49.7772C10.0141 49.9063 9.95875 50.1183 10.0325 50.3026C10.9874 53.0127 16.9563 58.6513 28.5566 57.1328C29.2277 58.2298 30.4131 59.3957 31.9884 59.299L32.7356 62.1565H29.2461C28.7365 62.1565 28.3236 62.569 28.3236 63.0783C28.3236 63.5875 28.7365 64 29.2461 64H33.9302H38.6166H46.1006C47.3068 63.9724 47.3206 62.1819 46.1006 62.1565H39.3593L38.28 57.3541C39.5761 56.7389 39.9313 55.0175 39.7929 53.8237C43.3169 51.8696 45.808 49.2056 46.8872 46.1269C48.6677 41.1217 47.2563 33.8764 44.9407 29.3045C43.5985 26.6267 41.1285 22.6423 41.878 20.6212C42.0809 20.0036 42.5514 19.5336 43.2986 19.1925C44.3042 18.7224 45.2451 19.1372 46.4444 19.6626C48.2802 20.4738 50.568 21.4878 53.8062 19.2755C54.1221 19.0681 54.0392 18.5147 53.6494 18.4456ZM43.4832 15.5513C42.2724 15.5282 42.2724 13.7307 43.4832 13.7077C44.694 13.7307 44.694 15.5282 43.4832 15.5513ZM34.6453 62.1558L33.7413 58.736C34.2833 58.3719 34.6615 57.775 34.8206 57.1505C35.3372 57.51 35.9 57.7128 36.4812 57.7405L37.4683 62.1558H34.6453Z"/>
                      </g>
                      <defs>
                        <clipPath id="clip0_57_557">
                          <rect width="64" height="64" fill="white"/>
                        </clipPath>
                      </defs>
                    </svg>
                  </div>

                  {/* XXL - Huge */}
                  <div className="flex flex-col items-center">
                    <svg 
                      className={`w-8 h-8 transition-colors duration-200 ${bird.size === 'huge' ? 'fill-white' : 'fill-white/40'}`} 
                      viewBox="0 0 64 64" 
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path d="M58.342 19.8767C56.3406 19.0992 54.9534 17.0992 54.9125 15.713C55.9695 15.1887 57.0086 14.0045 58.1475 13.9841C58.6031 14.0045 58.8386 13.3781 58.4854 13.0839C58.2294 12.8486 56.3458 11.3141 54.5746 10.9663C53.7966 10.0456 49.8449 5.93307 45.1765 9.30904C41.2145 12.1837 43.948 17.5036 46.1388 21.7691C47.421 24.3471 49.2714 27.5132 47.8075 28.4086C47.1114 28.5723 45.586 27.6005 43.989 26.5571C38.622 22.7975 31.1333 19.4677 23.7185 25.6977C21.2205 20.3474 15.5691 9.38064 10.9113 9.14559C7.55599 8.82334 4.69459 12.7389 6.76515 15.6314C3.35864 15.9971 1.5594 20.7363 4.66648 23.0587C2.1916 24.1686 0.53821 28.5215 3.87821 30.3012C2.62665 31.5825 1.66183 36.7948 5.36265 37.7592C5.12718 38.5367 4.74838 40.5419 6.48878 42.4549C7.00065 43.0176 7.66611 43.2426 8.44416 43.2426C11.4514 43.0943 15.0191 40.882 18.2721 40.9613C19.731 48.033 25.3489 53.8155 35.0616 55.7948V61.9482H30.5929C29.2569 61.9559 29.2441 63.9789 30.5929 63.9942C36.8634 64.0121 45.8492 63.9814 52.1581 63.9942C53.4992 63.961 53.5095 61.9789 52.1581 61.9482H43.9092V55.8228C53.6297 54.8254 58.3668 48.4598 59.7027 42.5339C61.0233 37.2142 60.2351 31.3525 57.9111 28.0173C57.5887 27.5467 57.2329 27.1528 56.8464 26.7794C52.9664 23.1707 52.7566 18.6798 53.2761 16.6135C53.573 18.9152 55.3979 22.7311 59.5184 24.7746C62.2672 24.4728 60.7904 20.6723 58.3411 19.8743L58.342 19.8767ZM37.0586 49.1142C27.3944 49.5899 22.6469 40.585 21.7126 36.7149C21.4976 36.0091 21.7433 35.2623 22.3268 34.8225C23.4836 33.9426 24.5202 34.9299 25.613 35.4874C25.334 34.2905 24.8196 32.1319 26.3501 31.4771C26.9644 31.2009 27.6707 31.3032 28.1827 31.7329C28.7867 32.2546 29.7285 32.7968 30.9161 33.3186C30.5552 32.4414 30.8111 31.362 31.6941 30.9451C35.4717 29.073 41.1539 31.2214 41.3891 31.3134C42.638 31.807 41.9265 33.6818 40.652 33.2163C40.611 33.1958 35.8506 31.4157 32.861 32.6638C32.9122 32.8581 32.9736 33.0424 33.0453 33.2163C33.657 34.5769 32.1367 36.0884 30.7725 35.4771C29.37 34.9043 28.2336 34.3108 27.3737 33.697C27.4146 34.3517 27.5477 34.9247 27.7627 35.4157C28.4384 36.8198 26.7825 38.3799 25.4184 37.6663C24.8656 37.4106 24.3639 37.1548 23.9237 36.899C25.2751 40.8581 28.5306 46.6997 35.963 47.0473C44.2218 47.6714 49.538 42.6152 46.876 35.7022C46.3846 34.4516 48.2401 33.6818 48.7699 34.9145C51.5263 42.5643 47.1195 49.0906 37.0586 49.1142ZM49.1798 10.649C50.5234 10.6746 50.5234 12.6694 49.1798 12.695C47.8361 12.6694 47.8361 10.6746 49.1798 10.649ZM37.1097 61.9482V56.0607C38.6581 56.2219 40.2578 56.2014 41.8625 56.071V61.9508H37.1097V61.9482Z"/>
                    </svg>
                  </div>
                </div>
                
                {/* Size Label */}
                <div className="text-center">
                  <span className="text-xs font-bold uppercase tracking-wider text-white">
                    {bird.size}
                  </span>
                </div>
              </div>

              {/* Add bottom padding to prevent content being hidden behind sticky button */}
              <div className="pb-32"></div>
            </div>

            {/* Sticky Collection Button */}
            <div className="fixed bottom-0 left-0 right-0 z-20 p-6" style={{ marginBottom: '30px' }}>
              <div className="max-w-sm mx-auto">
                {isCollected ? (
                  <Button
                    variant="outline"
                    onClick={handleCollectionToggle}
                    className="w-full bg-white/90 backdrop-blur-sm hover:bg-white/80 text-lg"
                    style={{ height: '60px' }}
                  >
                    Remove from Collection
                  </Button>
                ) : (
                  <Button
                    onClick={handleCollectionToggle}
                    className="w-full bg-white hover:bg-gray-100 text-black shadow-lg text-lg"
                    style={{ height: '60px' }}
                  >
                    <Plus className="h-5 w-5 mr-2" />
                    Add to Collection
                  </Button>
                )}
              </div>
            </div>
          </div>
        </div>
        )}
      </DialogContent>
    </Dialog>
  );
}
